### 목차
1. [웹 애플리케이션의 일반적인 보안 취약성](#웹-애플리케이션의-일반적인-보안-취약성)
    - [✨ 인증과 권한 부여의 취약성](#✨-인증과-권한-부여의-취약성)
        - [📌 인증(Authentication)이란?](#📌-인증authentication이란)
        - [📌 권한 부여(AUthorization)란?](#📌-권한-부여authorization란)
        - [❓ 인증 취약성이 있다는 것은](#❓-인증-취약성이-있다는-것은)
    - [✨ 세션 고정](#✨-세션-고정)
        - [📌 세션 고정(Session Fixation)이란?](#📌-세션-고정session-fixation이란)
        - [❓ 세션 고정을 악용하는 방법](#❓-세션-고정을-악용하는-방법)
            - [👉 애플리케이션이 세션 ID를 URL에 넣는 경우](#👉-애플리케이션이-세션-id를-url에-넣는-경우)
            - [👉 애플리케이션이 숨겨진 특성을 이용하는 경우](#👉-애플리케이션이-숨겨진-특성을-이용하는-경우)
            - [👉 애플리케이션이 세션 값을 쿠키에 저장하는 경우](#👉-애플리케이션이-세션-값을-쿠키에-저장하는-경우)
    - [✨ XSS(교차 사이트 스크립팅)](#✨-xss교차-사이트-스크립팅)
        - [📌 XSS(교차 사이트 스크립팅)이란?](#📌-xss교차-사이트-스크립팅이란)
    - [✨ CSRF(사이트 간 요청 위조)](#✨-csrf사이트-간-요청-위조)
        - [📌 CSRF(사이트 간 요청 위조)란?](#📌-csrf사이트-간-요청-위조란)
    - [✨ 주입](#✨-주입)
        - [📌 주입(Injection)이란?](#📌-주입injection이란)
        - [📌 주입 공격의 종류](#📌-주입-공격의-종류)
    - [✨ 기밀 데이터 노출](#✨-기밀-데이터-노출)
        - [📌 로그에 기록해서는 안될 정보를 포함하는 메시지](#📌-로그에-기록해서는-안될-정보를-포함하는-메시지)
    - [✨ 메서드 접근 제어 부족](#✨-메서드-접근-제어-부족)
    - [✨ 알려진 취약성이 있는 종속성 이용](#✨-알려진-취약성이-있는-종속성-이용)

---
# 웹 애플리케이션의 일반적인 보안 취약성
다음 8가지 일반적인 보안 취약성 목록은 애플리케이션 수준 보안에 대한 것이며 대부분이 `Spring Security` 사용과 직접 관련이 있다.

- 인증 취약성
- 세션 고정
- XSS(교차 사이트 스크립팅)
- CSRF(사이트 간 요청 위조)
- 주입
- 기밀 데이터 노출
- 메서드 접근 제어 부족
- 알려진 취약성이 있는 종속성 이용

## ✨ 인증과 권한 부여의 취약성
### 📌 인증(Authentication)이란?
> `인증`은 애플리케이션이 이를 이용하려는 사람을 식별하는 프로세스를 말한다.

즉, 사용자의 ID를 확인한 이후 식별된 사용자라면 데이터를 이용하거나 특정 작업을 수행할 수 있다.

또한 이런 과정을 거친 후에 `권한 부여` 프로세스를 시작할 수 있다.

### 📌 권한 부여(AUthorization)란?
> `권한 부여`는 인증된 호출자가 특정 기능과 데이터에 대한 이용 권리가 있는지 확인하는 프로세스를 말한다.

은행의 경우, 인증된 사용자는 자신의 계좌에서만 자금을 이체할 수 있도록 한다.

### ❓ 인증 취약성이 있다는 것은
사용자가 악의를 가지고 다른 사람의 기능이나 데이터에 접근할 수 있다는 의미이다.

`Spring Security`와 같은 프레임워크로 이러한 취약성이 발생할 우려를 줄일 수 있지만, 올바르게 이용하지 않으면 여전히 위험성은 존재한다.

즉, `Spring Security`를 사용하여 특정 역할이 있는 인증된 사용자만 특정 엔드포인트에 접근하도록 정의할 수 있지만, 데이터 수준에 제한이 없으면 다른 사용자의 데이터를 볼 수 있다는 허점이 발생할 수 있다.

<br>

❗ 예를 들어, 인증된 사용자가 `/products/{name}`으로 접근하여 자신의 제품을 확인한다.

해당 엔드포인트로 접근하여 제품을 반환받을 때, 이 제품이 인증된 사용자의 것인지 확인히지 않으면 다른 사용자의 제품을 확인할 수 있게 된다.

즉, `John`이 `/products/bill` 엔드포인트에 접근했을 때, 반환된 `Bill`의 데이터가 `John`의 것인지 확인하지 않으면 `John`이 `Bill`의 제품을 확인할 수 있다.

## ✨ 세션 고정
### 📌 세션 고정(Session Fixation)이란?
> `세션 고정` 취약성이 존재하면 공격자는 이미 생성된 세션 ID를 재이용해 유효한 사용자를 가장할 수 있다.

이 취약성은 인증 프로세스 중에 고유한 세션 ID를 할당하지 않아 기존 세션 ID가 재사용될 가능성이 있을 때 발생한다.

### ❓ 세션 고정을 악용하는 방법
이 취약성을 악용하려면 먼저 유효한 세션 ID를 획득한 후 의도한 피해자의 브라우저가 이를 이용하게 해야 한다.

#### 👉 애플리케이션이 세션 ID를 URL에 넣는 경우
피해자에게 악성 링크를 클릭하게 유인하는 방법을 사용할 수 있다.

#### 👉 애플리케이션이 숨겨진 특성을 이용하는 경우
피해자를 속여 외래 양식을 사용하도록 하고 작업을 서버로 게시할 수 있다.

#### 👉 애플리케이션이 세션 값을 쿠키에 저장하는 경우
공격자는 스크립트를 주입해 피해자의 브라우저가 스크립트를 실행하도록 할 수 있다.

## ✨ XSS(교차 사이트 스크립팅)
### 📌 XSS(교차 사이트 스크립팅)이란?
> `XSS`, 즉 교차 사이트 스크립팅은 서버에 노출된 웹 서비스로 클라이언트 쪽 스크립트를 주입해 다른 사용자가 이를 실행하도록 하는 공격이다.

원치 않는 외래 스크립트의 실행을 방지하기 위해 이용하기 전이나 저장하기 전에도 요청을 적절하게 소독하는 과정이 필요하다.

`XSS` 취약성이 악용되면 계정 가장(세션 고정과 결합)이나 DDoS와 같은 분산 공격 참여 등이 발생할 수 있다.

<br>

❗ 예를 들어, 한 SNS 웹 애플리케이션에서는 게시물을 게시할 수 있고 이 게시물이 모든 사용자에게 표시된다.

만약 한 사용자가 악성 스크립트를 게시했을 때, 브라우저에서 실행된다면 다음과 같은 문제가 발생할 수 있다.

1. 해커가 악성 스크립트를 포함한 댓글을 게시한다.
2. 앱은 요청을 확인하지 않고 저장한 후 그대로 반환하며, 다른 사용자들이 볼 수 있도록 이를 표시한다.
3. 다른 사용자들은 의도치 않게 해당 스크립트를 실행하고, 앱에 영향을 준다.

## ✨ CSRF(사이트 간 요청 위조)
### 📌 CSRF(사이트 간 요청 위조)란?
> `CSRF`, 즉 사이트 간 요청 위조는 특정 서버에서 작업을 호출하는 URL을 추출해 애플리케이션 외부에서 재사용할 수 있다고 가정한다.

`CSRF` 공격은 다음과 같은 과정을 통해 사용자가 서버에서 원치 않는 동작을 실행하도록 한다.

1. 사용자가 계정에 로그인한다.
2. 사용자가 위조된 코드가 포함된 페이지에 접근한다.
    - 위조된 페이지에는 사용자를 대신해 실행할 스크립트가 들어 있다.
3. 사용자가 위조된 코드가 포함된 페이지에 접근하면 사용자에게 스크립트가 전송되고 브라우저가 이를 실행한다.
4. 스크립트가 사용자를 대신해 동작을 실행한다.

보통 공격자는 `CSRF` 공격을 통해 시스템의 데이터를 변경하는 동작을 실행한다.

## ✨ 주입
### 📌 주입(Injection)이란?
> `주입` 공격에서 공격자는 시스템에 특정 데이터를 유입하는 취약성을 이용한다.

`주입`을 통해 시스템에 피해를 주고, 원치 않는 방법으로 데이터를 변경하거나 접근할 수 없는 데이터를 검색하는 것에 목표를 둔다.

### 📌 주입 공격의 종류
주입 공격은 시스템에 피해를 줄 목적의 클라이언트 쪽 스크립트를 주입한다.

- XSS(교차 사이트 스크립팅)
- SQL 주입
- XPath 주입
- OS 명령 주입
- LDAP 주입

위 예시 외에도 다양한 종류의 주입 공격가 존재한다.

## ✨ 기밀 데이터 노출
> 흔히 하는 실수에 의해 기밀 데이터가 노출될 수 있다.

### 📌 로그에 기록해서는 안될 정보를 포함하는 메시지
```
{
    "상태": 500,
    "오류": "내부 서버 오류",
    "메시지": "IP 주소 10.2.5.8/8080에 대한 연결이 발견되지 않음.",
    "경로": "/product/add"
}
```
위 예외 메시지에서는 IP 주소가 공개되었다.

공개된 주소를 통해 네트워크의 구성을 파악하고 인프라의 VM을 통제하는 방법을 찾아낼 수 있다.

또한 에러 메시지의 예외 스택에서 명명 방식이나 특정 작업에 이용되는 객체, 그리고 객체 간의 관계를 알 수 있고, 더 나아가 로그를 통해 종속성의 버전을 알 수도 있다.

```
응답 A:
{
    "상태": 401,
    "오류": "권한 없음",
    "메시지": "사용자 이름이 올바르지 않음",
    "경로": "/login"
}

응답 B:
{
    "상태": 401,
    "오류": "권한 없음",
    "메시지": "암호가 올바르지 않음",
    "경로": "/login"
}
```

위 메시지에서는 메시지의 내용을 통해 실행 컨텍스트를 분석할 수 있다.

즉, 사용자 이름은 맞고 암호가 틀렸다는 것을 알 수 있기 때문에 무차별 대입 공격에 취약하게 된다.

## ✨ 메서드 접근 제어 부족
> 애플리케이션 수준에서도 한 계층에만 권한 부여를 적용하면 안된다. 때에 따라 특정 기능을 아예 호출할 수 없게 해야 한다.

만약 권한 부여가 엔드포인트 수준에서만 수행된다면 컨트롤러 계층에만 권한 부여 규칙을 적용하고 싶을 수 있다.

하지만 향후 구현을 추가할 때 모든 권한 부여 요구사항을 테스트하지 않고 해당 기능을 노출하는 문제의 소지가 있다.

## ✨ 알려진 취약성이 있는 종속성 이용
> 개발을 진행할 때 사용하는 라이브러리나 프레임워크 같은 종속성에 취약성이 있을 수 있다.

이용하는 종속성을 항상 주의 깊게 살펴보고 알려진 취약성이 있는 버전은 제거해야 한다.

---
## 💎 References
- [스프링 시큐리티 인 액션](https://product.kyobobook.co.kr/detail/S000061695014)